{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://readdo.dev/schemas/artifact-envelope.schema.json",
    "title": "ReadDo Artifact Envelope (v1)",
    "type": "object",
    "additionalProperties": false,
    "required": ["artifact_type", "version", "created_by", "created_at", "meta", "payload"],
    "properties": {
      "artifact_type": {
        "type": "string",
        "enum": ["extraction", "summary", "score", "todos", "card", "export"]
      },
      "version": {
        "type": "integer",
        "minimum": 1
      },
      "created_by": {
        "type": "string",
        "enum": ["system", "user"]
      },
      "created_at": {
        "type": "string",
        "format": "date-time"
      },
      "meta": {
        "type": "object",
        "additionalProperties": false,
        "required": ["run_id", "engine_version", "template_version", "created_at", "created_by"],
        "properties": {
          "run_id": { "type": "string", "minLength": 6, "maxLength": 64 },
          "engine_version": { "type": "string", "minLength": 1, "maxLength": 32 },
          "template_version": { "type": "string", "minLength": 1, "maxLength": 64 },
          "created_at": { "type": "string", "format": "date-time" },
          "created_by": { "type": "string", "enum": ["system", "user"] },
  
          "model_id": { "type": "string", "minLength": 0, "maxLength": 64 },
          "prompt_hash": { "type": "string", "minLength": 0, "maxLength": 128 },
          "input_hash": { "type": "string", "minLength": 0, "maxLength": 128 },
          "upstream_versions": {
            "type": "object",
            "description": "Map of upstream artifact versions used to produce this artifact.",
            "additionalProperties": { "type": "integer", "minimum": 1 }
          }
        }
      },
      "payload": {
        "type": "object",
        "description": "Artifact payload validated by the corresponding artifact schema."
      }
    }
  }
  