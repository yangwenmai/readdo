{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://readdo.dev/schemas/todos.schema.json",
    "title": "ReadDo Todos Artifact (v1)",
    "type": "object",
    "additionalProperties": false,
    "required": ["todos"],
    "properties": {
      "todos": {
        "type": "array",
        "description": "Actionable tasks derived from the content and the user's intent.",
        "minItems": 3,
        "maxItems": 7,
        "items": {
          "type": "object",
          "additionalProperties": false,
          "required": ["title", "eta"],
          "properties": {
            "title": {
              "type": "string",
              "description": "Verb-led task title. Start with an imperative verb (e.g., Draft, Skim, Compare, Extract, Implement / 写、整理、对比、实现、制定).",
              "minLength": 8,
              "maxLength": 140,
              "pattern": "^(?:[A-Z][a-zA-Z]+\\b.*|[\\u4E00-\\u9FFF].*)$"
            },
            "eta": {
              "type": "string",
              "description": "Estimated effort bucket.",
              "enum": ["10m", "20m", "30m", "45m", "1h", "2h", "3h+"]
            },
            "type": {
              "type": "string",
              "description": "Optional task type for grouping and downstream exports.",
              "enum": ["READ", "WRITE", "BUILD", "SHARE", "RESEARCH", "REVIEW", "DECIDE"]
            },
            "why": {
              "type": "string",
              "description": "Optional short rationale linking this task to the user's intent.",
              "minLength": 0,
              "maxLength": 200
            },
            "priority": {
              "type": "string",
              "description": "Optional per-task priority (not the same as item priority).",
              "enum": ["P0", "P1", "P2", "P3"]
            },
            "tags": {
              "type": "array",
              "description": "Optional lightweight tags.",
              "minItems": 0,
              "maxItems": 5,
              "items": { "type": "string", "minLength": 1, "maxLength": 24 }
            }
          }
        }
      },
      "constraints": {
        "type": "object",
        "description": "Optional global constraints used to generate todos (for traceability).",
        "additionalProperties": false,
        "required": [],
        "properties": {
          "must_include_output_task": {
            "type": "boolean",
            "description": "Whether the generator was instructed to include at least one output-type task."
          }
        }
      }
    },
    "allOf": [
      {
        "description": "MVP governance rule: should include at least one output-oriented task (WRITE/SHARE/BUILD/DECIDE).",
        "anyOf": [
          {
            "properties": {
              "todos": {
                "contains": {
                  "type": "object",
                  "properties": { "type": { "enum": ["WRITE", "SHARE", "BUILD", "DECIDE"] } },
                  "required": ["type"]
                }
              }
            }
          },
          {
            "description": "Allow MVP fallback only when no todo.type is provided yet.",
            "not": {
              "properties": {
                "todos": {
                  "contains": {
                    "type": "object",
                    "required": ["type"]
                  }
                }
              }
            }
          }
        ]
      }
    ]
  }
  